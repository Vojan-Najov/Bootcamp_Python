from bs4 import BeautifulSoup

with open("evilcorp.html", 'r', encoding='UTF-8') as file:
    html_doc = file.read()

print(html_doc)

soup = BeautifulSoup(html_doc, 'html.parser')
print(soup.prettify())
soup.title.string.replace_with("Evil Corp - Stealing your money every day")
_, pronoun, name = soup.p.strings
h1_tag = soup.new_tag('h1')
h1_tag.string = f'{pronoun}{name}, you are hacked!'
soup.body.insert(1, h1_tag)

soup.body.findAll('p')[1].a['href'] = 'https://mrrobot.fandom.com/wiki/Fsociety'

print(soup.prettify())

script_tag = soup.new_tag('script')
script_tag.string = '''
 <script>
        hacked = function() {
            alert('hacked');
        }
        window.addEventListener('load', 
          function() { 
            var f = document.querySelector("form");
            f.setAttribute("onsubmit", "hacked()");
          },
          false
        );
</script>
'''

soup.body.append(script_tag)

with open("evilcorp_hacked.html", 'w', encoding='UTF-8') as file:
    file.write(soup.prettify())



